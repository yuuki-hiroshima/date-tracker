<!-- AIが出力 → 書き写し -->

<!doctype html>
<html lang="ja">
    <head>
        <script>
            (function() {
                try {
                    var t = localStorage.getItem('theme');
                    if (t === 'dark') document.documentElement.setAttribute('data-theme', 'dark');
                } catch (e) {}
            })();
        </script>
        <meta charset="utf-8">
        <title>Date-Tracker</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    </head>
    <body>
        <header>
            <h1 class="logo">
                <a href="{{ url_for('index') }}" aria-label="Date-Tracker トップへ">
                    <span class="accent">Date</span><span class="hyphen">-</span><span class="tail">Tracker</span>
                    <span class="badge">DT</span>
                </a>
            </h1>
            <nav>
                <a class="btn" href="{{ url_for('index') }}">トップ</a>
                <a class="btn" href="{{ url_for('add') }}">登録</a>
                <a class="btn" href="{{ url_for('list_view') }}">一覧</a>
                <a class="btn" href="{{ url_for('elapsed') }}">経過日</a>
            </nav>
        </header>

        <!-- フラッシュメッセージ -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash {{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- 子テンプレートをここに差し込む -->
        {% block content %}{% endblock %}

        <footer>
            <button id="theme-toggle" class="btn secondary" aria-label="テーマ切替">🌓テーマ</button>
            <small>&copy; 2025 date-tracker</small>
        </footer>
        <script src="{{ url_for('static', filename='theme.js') }}"></script>
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                document.querySelectorAll('.date-field').forEach(field => {
                    const input = field.querySelector('input[type="date"]');
                    const btn   = field.querySelector('.date-btn');
                    if (!input || !btn) return;
                    btn.addEventListener('click', () => {
                        if (input.showPicker) {
                            input.showPicker();        // Chrome / 新しめのSafari/Edge
                        } else {
                        input.focus();             // フォールバック
                    }
                });
            });
        });
        </script>
    </body>
</html>