<!doctype html>
<html lang="ja">
  <head>
    <script>
      (function () {
        try {
          var t = localStorage.getItem('theme'); // 'dark' or 'light' or null
          var root = document.documentElement;
          if (t === 'dark') {
            root.setAttribute('data-theme','dark');
          } else if (t === 'light') {
            root.removeAttribute('data-theme');
          } else {
            // æœªä¿å­˜æ™‚ã¯ OS è¨­å®šã«è¿½å¾“
            var prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (prefersDark) root.setAttribute('data-theme','dark');
          }
        } catch(e) {}
      })();
    </script>
    <meta charset="utf-8">
    <title>Date-Tracker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- ä¸­å¤®å¯„ã›ã‚„ãƒ•ã‚©ãƒ¼ãƒ å¹…ãªã©ã¯ style.css ã«è¿½åŠ æ¸ˆã¿ã® .shell / .content / form ã‚’ä½¿ã„ã¾ã™ -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  </head>
  <body>
    <!-- â–¼ ãƒšãƒ¼ã‚¸å…¨ä½“ã®ä¸­å¤®ã‚«ãƒ©ãƒ ï¼ˆå·¦å³ä¸­å¤®å¯„ã›ï¼†æœ€å¤§å¹…åˆ¶å¾¡ï¼‰ -->
    <div class="shell">
      <header>
        <h1 class="logo">
          <a href="{{ url_for('index') }}" aria-label="Date-Tracker ãƒˆãƒƒãƒ—ã¸">
            <span class="accent">Date</span><span class="hyphen">-</span><span class="tail">Tracker</span>
            <span class="badge">DT</span>
          </a>
        </h1>
        <nav>
          <a class="btn" href="{{ url_for('index') }}">ãƒˆãƒƒãƒ—</a>
          <a class="btn" href="{{ url_for('add') }}">ç™»éŒ²</a>
          <a class="btn" href="{{ url_for('list_view') }}">ä¸€è¦§</a>
          <a class="btn" href="{{ url_for('elapsed') }}">çµŒéæ—¥</a>
        </nav>
      </header>

      <!-- ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            <div class="flash {{ category }}">{{ message }}</div>
          {% endfor %}
        {% endif %}
      {% endwith %}

      <!-- â–¼ ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç”¨ã®ä¸­å¤®ã‚«ãƒ©ãƒ é ˜åŸŸ -->
      <main class="content">
        {% block content %}{% endblock %}
      </main>

      <footer>
        <button id="theme-toggle" class="btn secondary" aria-label="ãƒ†ãƒ¼ãƒåˆ‡æ›¿">ğŸŒ“ãƒ†ãƒ¼ãƒ</button>
        <small>&copy; 2025 date-tracker</small>
      </footer>
    </div>
    <!-- â–² .shell ãŠã‚ã‚Š -->

    <script src="{{ url_for('static', filename='theme.js') }}"></script>

    <!-- æ—¥ä»˜ãƒ”ãƒƒã‚«ãƒ¼ã®ãƒœã‚¿ãƒ³ï¼ˆ.date-btnï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã§é–‹ãç”¨ã€‚æ‹¬å¼§ã®ã‚ºãƒ¬ã‚’ä¿®æ­£æ¸ˆã¿ -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.date-field').forEach(field => {
          const input = field.querySelector('input[type="date"]');
          const btn   = field.querySelector('.date-btn');
          if (!input || !btn) return;

          btn.addEventListener('click', () => {
            if (input.showPicker) {
              // Chrome / æ–°ã—ã‚ã® Safari / Edge
              input.showPicker();
            } else {
              // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
              input.focus();
            }
          });
        });
      });
    </script>
  </body>
</html>